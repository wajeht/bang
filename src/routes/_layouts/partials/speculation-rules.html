<script>
	if (HTMLScriptElement.supports && HTMLScriptElement.supports("speculationrules")) {
		const specScript = document.createElement("script");
		specScript.type = "speculationrules";

		// AGGRESSIVE SPECULATION RULES - Maximum Speed Configuration
		const specRules = {
			// === PRERENDER RULES ===
			// Prerender core app pages - instant navigation
			"prerender": [
				{
					"urls": [
						"/actions",
						"/bookmarks",
						"/notes",
						"/tabs",
						"/reminders",
						"/settings",
						"/settings/account",
						"/settings/data",
						"/about",
						"/bangs",
						"/privacy-policy",
						"/terms-of-service"
					],
					"eagerness": "eager"
				}
			],

			// === PREFETCH RULES ===
			// Prefetch on hover - covers dynamic URLs and detail pages
			"prefetch": [
				{
					// Detail pages with IDs
					"where": {
						"or": [
							{ "href_matches": "/actions/*/edit" },
							{ "href_matches": "/bookmarks/*/edit" },
							{ "href_matches": "/notes/*" },
							{ "href_matches": "/tabs/*/edit" },
							{ "href_matches": "/tabs/*/items/*" },
							{ "href_matches": "/reminders/*/edit" }
						]
					},
					"eagerness": "eager"
				},
				{
					// Create pages
					"urls": [
						"/actions/create",
						"/bookmarks/create",
						"/notes/create",
						"/tabs/create",
						"/reminders/create"
					],
					"eagerness": "eager"
				}
			]
		};

		specScript.textContent = JSON.stringify(specRules);
		document.head.appendChild(specScript);

		console.log('âœ… Speculation rules added:', specRules);
		console.log('ğŸ” Debug: Check DevTools > Application > Speculative loads');

		if (document.prerendering) {
			console.log('ğŸš€ Page is being prerendered!');
			document.addEventListener("prerenderingchange", () => {
				console.log('âš¡ Page activated from prerender!', {
					activationStart: performance.getEntriesByType('navigation')[0]?.activationStart
				});
			}, { once: true });
		}

		document.addEventListener('DOMContentLoaded', () => {
			const nav = performance.getEntriesByType('navigation')[0];
			if (nav?.activationStart > 0) {
				console.log('ğŸ“Š Prerendered! Activation:', nav.activationStart + 'ms');
			}
		});

	} else {
		console.log('âŒ Speculation rules not supported');
	}
</script>
