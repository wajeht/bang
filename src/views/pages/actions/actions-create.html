<section style="display: flex; flex-direction: column; gap: 20px;">
    <header>
        <h2>‚ö° Actions / New</h2>
        <p>Create a new action</p>
    </header>

    <form
        method="POST"
        action="/actions"
        style="border-style: solid; border-radius: 5px; padding: 20px; width: 32.5%; display: flex; flex-direction: column; gap: 10px;"
    >
        <input type="hidden" id="csrfToken" name="csrfToken" value="<%= csrfToken %>" />

        <fieldset style="border: none; padding: 0; margin: 0;">
            <legend style="font-weight: bold; margin-bottom: 15px;">Action Details</legend>

            <%- include('../../components/inputs/text.html', {
                id: 'name',
                name: 'name',
                label: 'üìù Name',
                placeholder: 'Google Search',
                value: state.input.name ?? '',
                required: true,
                helpText: 'A descriptive name for your action',
                error: state.errors.name
            }) %>

            <div style="display: flex; flex-direction: column; gap: 5px; margin-bottom: 15px;">
                <label for="trigger">‚ö° Trigger <abbr title="Required">*</abbr></label>
                <div style="display: flex; align-items: center; gap: 5px;">
                    <span style="font-size: 1.2em;" aria-hidden="true">!</span>
                    <input
                        type="text"
                        name="trigger"
                        id="trigger"
                        placeholder="g"
                        value="<%= state.input.trigger ?? '' %>"
                        required
                        aria-describedby="trigger-help <%= state.errors.trigger ? 'trigger-error' : '' %>"
                    >
                </div>
                <small id="trigger-help">The command to trigger this action (e.g., 'g' for Google)</small>
                <% if (state.errors.trigger) { %>
                    <small id="trigger-error" style="color: red;" role="alert"><%= state.errors.trigger %></small>
                <% } %>
            </div>

            <div style="display: flex; flex-direction: column; gap: 5px; margin-bottom: 15px;">
                <label for="url">üåê URL <abbr title="Required">*</abbr></label>
                <input
                    type="url"
                    name="url"
                    id="url"
                    placeholder="https://google.com/search?q={query}"
                    value="<%= state.input.url ?? '' %>"
                    required
                    aria-describedby="url-help <%= state.errors.url ? 'url-error' : '' %>"
                >
                <small id="url-help">For search actions, use {query} where the search term should go</small>
                <% if (state.errors.url) { %>
                    <small id="url-error" style="color: red;" role="alert"><%= state.errors.url %></small>
                <% } %>
            </div>

            <div style="display: flex; flex-direction: column; gap: 5px; margin-bottom: 15px;">
                <label for="actionType">üè∑Ô∏è Action Type <abbr title="Required">*</abbr></label>
                <select
                    id="actionType"
                    name="actionType"
                    required
                    aria-describedby="actionType-help"
                >
                    <option value="">Choose an action type</option>
                    <% actionTypes.forEach(type => { %>
                        <option value="<%= type %>" <%= state.input.actionType === type ? 'selected' : '' %>>
                            <%= type.charAt(0).toUpperCase() + type.slice(1) %>
                        </option>
                    <% }); %>
                </select>
                <small id="actionType-help">Select the type of action to perform</small>
            </div>
        </fieldset>

        <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 10px;">
            <button type="button" onclick="location.href='/actions'">‚ùå Cancel</button>
            <button type="submit">üíæ Save</button>
        </div>
    </form>
</section>
