<section style="display: flex; flex-direction: column; gap: 30px;">
    <header>
        <h2>‚è∞ Reminders / New</h2>
        <p>Create a new reminder</p>
    </header>

    <form
        method="POST"
        action="/reminders"
        style="width: 32.5%; display: flex; flex-direction: column; gap: 10px;"
    >
        <fieldset style="display: flex; flex-direction: column;">
            <legend>Reminder Details</legend>

            <input type="hidden" name="csrfToken" value="<%= csrfToken %>" />

            <%- include('../../components/inputs/text.html', {
                id: 'title',
                name: 'title',
                label: 'üìù Title',
                placeholder: 'Take out trash',
                value: state.input && state.input.title ? state.input.title : '',
                required: true,
                helpText: 'What do you want to be reminded about?',
                error: state.errors && state.errors.title ? state.errors.title : undefined
            }) %>

            <%- include('../../components/inputs/url.html', {
                id: 'url',
                name: 'url',
                label: 'üîó URL (optional)',
                placeholder: 'https://example.com',
                value: state.input && state.input.url ? state.input.url : '',
                required: false,
                helpText: 'Optional link to open with this reminder',
                error: state.errors && state.errors.url ? state.errors.url : undefined
            }) %>

            <%- include('../../components/inputs/select.html', {
                id: 'when',
                name: 'when',
                label: '‚è∞ When',
                required: true,
                value: state.input && state.input.when ? state.input.when : 'tomorrow',
                options: timingOptions,
                helpText: 'When should you be reminded? Choose from preset options or select Custom Date for a specific date.',
                error: state.errors && state.errors.when ? state.errors.when : undefined
            }) %>

            <%- include('../../components/inputs/date.html', {
                id: 'custom_date',
                name: 'custom_date',
                label: 'üìÖ Custom Date',
                value: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                required: false,
                helpText: 'Select a specific date (only shown when Custom Date is selected)',
                error: undefined,
                style: 'display: none;'
            }) %>

        </fieldset>

        <div style="display: flex; justify-content: flex-end; gap: 10px;">
            <button type="button" onclick="location.href='/reminders'">‚ùå Cancel</button>
            <button type="submit">üíæ Save</button>
        </div>
    </form>

    <script>
        const whenSelect = document.getElementById('when');
        const customDateContainer = document.getElementById('custom_date').closest('div');

        function toggleCustomDateField() {
            if (whenSelect.value === 'custom') {
                customDateContainer.style.display = 'block';
                document.getElementById('custom_date').required = true;
            } else {
                customDateContainer.style.display = 'none';
                document.getElementById('custom_date').required = false;
            }
        }

        whenSelect.addEventListener('change', toggleCustomDateField);
        
        // Initialize on page load
        toggleCustomDateField();
    </script>

</section>
