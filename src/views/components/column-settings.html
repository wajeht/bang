<button onclick="document.getElementById('question-mark-btn').showModal()">⚙️</button>

<dialog id="question-mark-btn">
  <h2>🎨 Display</h2>
  <p>Customize how your data is displayed.</p>

  <form action="/settings/display" method="POST" style="width: 100%; display: flex; flex-direction: column; gap: 20px; margin-top: 20px;">
    <%- include('../components/input-csrf.html') %>

    <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: space-between;">
      <!-- Actions -->
      <div style="display: flex; flex-direction: column; gap: 15px; <%- path === '/actions' ? null : 'display: none;' %>">
        <% if (path === "/actions") { %>
            <input type="hidden" name="path" value="<%= path %>" />
        <% } %>

        <!-- Items Per Page -->
        <div style="display: flex; flex-direction: column; gap: 5px;">
          <label for="actions_per_page">🔢 Items Per Page<span style="color: red;">*</span></label>
          <input
            type="number"
            id="actions_per_page"
            name="column_preferences[actions][default_per_page]"
            value="<%= state.input.actions_per_page ?? user.column_preferences.actions.default_per_page %>"
            min="1"
            required
          >
        </div>

        <!-- Visible Columns -->
        <div style="display: flex; flex-direction: column; gap: 8px;">
          <h4 style="margin: 0; font-weight: normal;">Columns<span style="color: red;">*</span></h4>
          <label style="display: flex; align-items: center; gap: 10px;">
            <input
              type="checkbox"
              name="column_preferences[actions][name]"
              <%= user.column_preferences?.actions?.name !== false ? 'checked' : '' %>
            >
            📝 Name
          </label>
          <label style="display: flex; align-items: center; gap: 10px;">
            <input
              type="checkbox"
              name="column_preferences[actions][trigger]"
              <%= user.column_preferences?.actions?.trigger !== false ? 'checked' : '' %>
            >
            🔥 Trigger
          </label>
          <label style="display: flex; align-items: center; gap: 10px;">
            <input
              type="checkbox"
              name="column_preferences[actions][url]"
              <%= user.column_preferences?.actions?.url !== false ? 'checked' : '' %>
            >
            🌐 URL
          </label>
          <label style="display: flex; align-items: center; gap: 10px;">
            <input
              type="checkbox"
              name="column_preferences[actions][action_type]"
              <%= user.column_preferences?.actions?.action_type !== false ? 'checked' : '' %>
            >
            🏷️ Type
          </label>
          <label style="display: flex; align-items: center; gap: 10px;">
            <input
              type="checkbox"
              name="column_preferences[actions][created_at]"
              <%= user.column_preferences?.actions?.created_at !== false ? 'checked' : '' %>
            >
            📅 Created At
          </label>
        </div>
      </div>

      <!-- Bookmarks -->
      <div style="display: flex; flex-direction: column; gap: 15px; <%- path === '/bookmarks' ? null : 'display: none;' %>">
        <% if (path === "/bookmarks") { %>
            <input type="hidden" name="path" value="<%= path %>" />
        <% } %>

        <!-- Items Per Page -->
        <div style="display: flex; flex-direction: column; gap: 5px;">
          <label for="bookmarks_per_page">🔢 Items Per Page<span style="color: red;">*</span></label>
          <input
            type="number"
            id="bookmarks_per_page"
            name="column_preferences[bookmarks][default_per_page]"
            value="<%= state.input.bookmarks_per_page ?? user.column_preferences.bookmarks.default_per_page %>"
            min="1"
            required
          >
        </div>

        <!-- Visible Columns -->
        <div style="display: flex; flex-direction: column; gap: 8px;">
          <h4 style="margin: 0; font-weight: normal;">Columns<span style="color: red;">*</span></h4>
          <label style="display: flex; align-items: center; gap: 10px;">
            <input
              type="checkbox"
              name="column_preferences[bookmarks][title]"
              <%= user.column_preferences?.bookmarks?.title !== false ? 'checked' : '' %>
            >
            📝 Title
          </label>
          <label style="display: flex; align-items: center; gap: 10px;">
            <input
              type="checkbox"
              name="column_preferences[bookmarks][url]"
              <%= user.column_preferences?.bookmarks?.url !== false ? 'checked' : '' %>
            >
            🌐 URL
          </label>
          <label style="display: flex; align-items: center; gap: 10px;">
            <input
              type="checkbox"
              name="column_preferences[bookmarks][created_at]"
              <%= user.column_preferences?.bookmarks?.created_at !== false ? 'checked' : '' %>
            >
            📅 Created At
          </label>
        </div>
      </div>

      <!-- Notes -->
      <div style="<%- path === '/notes' ? null : 'display: none;' %>">
        <% if (path === "/notes") { %>
            <input type="hidden" name="path" value="<%= path %>" />
        <% } %>

        <div style="display: flex; flex-direction: column; gap: 15px;">
          <!-- Items Per Page -->
          <div style="display: flex; flex-direction: column; gap: 5px;">
            <label for="notes_per_page">🔢 Items Per Page<span style="color: red;">*</span></label>
            <input
              type="number"
              id="notes_per_page"
              name="column_preferences[notes][default_per_page]"
              value="<%= state.input.notes_per_page ?? user.column_preferences.notes.default_per_page %>"
              min="1"
              required
            >
          </div>

          <!-- Visible Columns -->
          <div style="display: flex; flex-direction: column; gap: 8px;">
            <h4 style="margin: 0; font-weight: normal;">Columns<span style="color: red;">*</span></h4>
            <label style="display: flex; align-items: center; gap: 10px;">
              <input
                type="checkbox"
                name="column_preferences[notes][title]"
                <%= user.column_preferences?.notes?.title !== false ? 'checked' : '' %>
              >
              📝 Title
            </label>
            <label style="display: flex; align-items: center; gap: 10px;">
              <input
                type="checkbox"
                name="column_preferences[notes][content]"
                <%= user.column_preferences?.notes?.content !== false ? 'checked' : '' %>
              >
              📝 Content
            </label>
            <label style="display: flex; align-items: center; gap: 10px;">
              <input
                type="checkbox"
                name="column_preferences[notes][created_at]"
                <%= user.column_preferences?.notes?.created_at !== false ? 'checked' : '' %>
              >
              📅 Created At
            </label>
          </div>
        </div>

        <!-- Default View -->
        <div style="display: flex; flex-direction: column; gap: 8px; margin-top: 10px;">
          <h4 style="margin: 0; font-weight: normal;">Default View<span style="color: red;">*</span></h4>
          <label style="display: flex; align-items: center; gap: 10px;">
            <input
              type="radio"
              name="column_preferences[notes][view_type]"
              value="table"
              <%= user.column_preferences?.notes?.view_type !== 'card' ? 'checked' : '' %>
            >
            📋 Table View
          </label>
          <label style="display: flex; align-items: center; gap: 10px;">
            <input
              type="radio"
              name="column_preferences[notes][view_type]"
              value="card"
              <%= user.column_preferences?.notes?.view_type === 'card' ? 'checked' : '' %>
            >
            🗂️ Card View
          </label>
        </div>
      </div>
    </div>

    <% if (state.errors.column_preferences) { %>
      <small style="color: red;"><%= state.errors.column_preferences %></small>
    <% } %>

    <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
      <button type="button" onclick="this.closest('dialog').close()">❌ Cancel</button>
      <button type="submit">💾 Save</button>
    </div>
  </form>
</dialog>
