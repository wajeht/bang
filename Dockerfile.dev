FROM node:24-slim

RUN apt-get update && \
    apt-get install -y --no-install-recommends \
    chromium \
    fonts-liberation \
    libnss3 \
    libatk-bridge2.0-0 \
    libdrm2 \
    libxkbcommon0 \
    libgbm1 \
    libasound2 && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Tell Playwright to skip downloading browsers and use system Chromium
ENV PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD=1
ENV PLAYWRIGHT_CHROMIUM_EXECUTABLE_PATH=/usr/bin/chromium
ENV CHROME_BIN=/usr/bin/chromium
ENV CHROME_PATH=/usr/bin/chromium

WORKDIR /usr/src/app

COPY package.json package-lock.json ./

RUN npm install

COPY ./ ./

EXPOSE 80

CMD ["npm", "run", "dev"]
